var COMPILED=!0,goog=goog||{};goog.global=this;goog.define=function(a,b){var m=b;COMPILED||goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(m=goog.global.CLOSURE_DEFINES[a]);goog.exportPath_(a,m)};goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;
goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};
COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.exportPath_=function(a,b,m){a=a.split(".");m=m||goog.global;a[0]in m||!m.execScript||m.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&goog.isDef(b)?m[e]=b:m=m[e]?m[e]:m[e]={}};goog.getObjectByName=function(a,b){for(var m=a.split("."),e=b||goog.global,d;d=m.shift();)if(goog.isDefAndNotNull(e[d]))e=e[d];else return null;return e};
goog.globalize=function(a,b){var m=b||goog.global,e;for(e in a)m[e]=a[e]};goog.addDependency=function(a,b,m){if(!COMPILED){var e;a=a.replace(/\\/g,"/");for(var d=goog.dependencies_,p=0;e=b[p];p++)d.nameToPath[e]=a,a in d.pathToNames||(d.pathToNames[a]={}),d.pathToNames[a][e]=!0;for(e=0;b=m[e];e++)a in d.requires||(d.requires[a]={}),d.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a,b){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];
!COMPILED&&goog.ENABLE_DEBUG_LOADER&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var m=a[b].src,e=m.lastIndexOf("?"),e=
-1==e?m.length:e;if("base.js"==m.substr(e-7,7)){goog.basePath=m.substr(0,e-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){if(goog.inHtmlDocument_()){var b=goog.global.document;if("complete"==b.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}b.write('<script type="text/javascript" src="'+
a+'">\x3c/script>');return!0}return!1},goog.writeScripts_=function(){function a(d){if(!(d in e.written)){if(!(d in e.visited)&&(e.visited[d]=!0,d in e.requires))for(var l in e.requires[d])if(!goog.isProvided_(l))if(l in e.nameToPath)a(e.nameToPath[l]);else throw Error("Undefined nameToPath for "+l);d in m||(m[d]=!0,b.push(d))}}var b=[],m={},e=goog.dependencies_,d;for(d in goog.included_)e.written[d]||a(d);for(d=0;d<b.length;d++)if(b[d])goog.importScript_(goog.basePath+b[d]);else throw Error("Undefined script input");
},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var m=Object.prototype.toString.call(a);if("[object Window]"==m)return"object";if("[object Array]"==m||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==m||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},m;for(m in a)b[m]=goog.cloneObject(a[m]);return b}return a};goog.bindNative_=function(a,b,m){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,m){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(d,e);return a.apply(b,d)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,m){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var m=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,m);return a.apply(this,b)}};goog.mixin=function(a,b){for(var m in b)a[m]=b[m]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,m=b.createElement("script");m.type="text/javascript";m.defer=!1;m.appendChild(b.createTextNode(a));b.body.appendChild(m);
b.body.removeChild(m)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var m=function(a){return goog.cssNameMapping_[a]||a},e=function(a){a=a.split("-");for(var b=[],l=0;l<a.length;l++)b.push(m(a[l]));return b.join("-")},e=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?m:e:function(a){return a};return b?a+"-"+e(b):e(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){var m=b||{},e;for(e in m){var d=(""+m[e]).replace(/\$/g,"$$$$");a=a.replace(RegExp("\\{\\$"+e+"\\}","gi"),d)}return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,m){goog.exportPath_(a,b,m)};goog.exportProperty=function(a,b,m){a[b]=m};
goog.inherits=function(a,b){function m(){}m.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new m;a.prototype.constructor=a};
goog.base=function(a,b,m){var e=arguments.callee.caller;if(goog.DEBUG&&!e)throw Error("arguments.caller not defined.  goog.base() expects not to be running in strict mode. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(e.superClass_)return e.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var d=Array.prototype.slice.call(arguments,2),p=!1,l=a.constructor;l;l=l.superClass_&&l.superClass_.constructor)if(l.prototype[b]===e)p=!0;else if(p)return l.prototype[b].apply(a,
d);if(a[b]===e)return a.constructor.prototype[b].apply(a,d);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){a.call(goog.global)};/*

 Lo-Dash 1.3.1 (Custom Build) <http://lodash.com/>
 Build: `lodash modern -o ./dist/lodash.js`
 Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 Available under MIT license <http://lodash.com/license>
*/
(function(a){function b(a,c,b){b=(b||0)-1;for(var f=a.length;++b<f;)if(a[b]===c)return b;return-1}function m(a,c){var f=typeof c;a=a.cache;if("boolean"==f||null==c)return a[c];"number"!=f&&"string"!=f&&(f="object");var d="number"==f?c:aa+c;a=a[f]||(a[f]={});return"object"==f?a[d]&&-1<b(a[d],c)?0:-1:a[d]?0:-1}function e(a){var c=this.cache,b=typeof a;if("boolean"==b||null==a)c[a]=!0;else{"number"!=b&&"string"!=b&&(b="object");var f="number"==b?a:aa+a,d=c[b]||(c[b]={});"object"==b?(d[f]||(d[f]=[])).push(a)==
this.array.length&&(c[b]=!1):d[f]=!0}}function d(a){return a.charCodeAt(0)}function p(a,c){var b=a.index,f=c.index;a=a.criteria;c=c.criteria;if(a!==c){if(a>c||"undefined"==typeof a)return 1;if(a<c||"undefined"==typeof c)return-1}return b<f?-1:1}function l(a){var c=-1,b=a.length,f=x();f["false"]=f["null"]=f["true"]=f.undefined=!1;var d=x();d.array=a;d.cache=f;for(d.push=e;++c<b;)d.push(a[c]);return!1===f.object?(r(d),null):d}function v(a){return"\\"+Ba[a]}function t(){return u.pop()||[]}function x(){return z.pop()||
{array:null,cache:null,criteria:null,"false":!1,index:0,leading:!1,maxWait:0,"null":!1,number:null,object:null,push:null,string:null,trailing:!1,"true":!1,undefined:!1,value:null}}function w(a){a.length=0;u.length<Y&&u.push(a)}function r(a){var c=a.cache;c&&r(c);a.array=a.cache=a.criteria=a.object=a.number=a.string=a.value=null;z.length<Y&&z.push(a)}function c(a,c,b){c||(c=0);"undefined"==typeof b&&(b=a?a.length:0);var f=-1;b=b-c||0;for(var d=Array(0>b?0:b);++f<b;)d[f]=a[c+f];return d}function f(e){function g(a){return a&&
"object"==typeof a&&!K(a)&&E.call(a,"__wrapped__")?a:new u(a)}function u(a){this.__wrapped__=a}function Y(a,h,k,q){function c(){var q=arguments,d=g?this:h;Q||(a=h[b]);k.length&&(q=q.length?(q=D.call(q),f?q.concat(k):k.concat(q)):k);return this instanceof c?(d=M(a.prototype)?pa(a.prototype):{},q=a.apply(d,q),M(q)?q:d):a.apply(d,q)}var Q=T(a),g=!k,b=h;if(g){var f=q;k=h}else if(!Q){if(!q)throw new tb;h=a}return c}function z(a){return Wa[a]}function J(a,h,k){var q=(q=g.indexOf)===Xa?b:q;return q}function $(a){return function(h,
k,q,c){"boolean"!=typeof k&&null!=k&&(q=(c=q)&&c[k]===h?n:k,k=!1);null!=q&&(q=g.createCallback(q,c));return a(h,k,q,c)}}function Ba(a){var h,k;if(!a||F.call(a)!=U||(h=a.constructor,T(h)&&!(h instanceof h)))return!1;Z(a,function(h,a){k=a});return k===n||E.call(a,k)}function ub(a){return vb[a]}function Ca(a,h,k,q,y,Q){var b=a;"boolean"!=typeof h&&null!=h&&(q=k,k=h,h=!1);if("function"==typeof k){k="undefined"==typeof q?k:g.createCallback(k,q,1);b=k(b);if("undefined"!=typeof b)return b;b=a}if(q=M(b)){var f=
F.call(b);if(!N[f])return b;var d=K(b)}if(!q||!h)return q?d?c(b):Da({},b):b;q=R[f];switch(f){case fa:case ga:return new q(+b);case ha:case ba:return new q(b);case ia:return q(b.source,wb.exec(b))}f=!y;y||(y=t());Q||(Q=t());for(var e=y.length;e--;)if(y[e]==a)return Q[e];b=d?q(b.length):{};d&&(E.call(a,"index")&&(b.index=a.index),E.call(a,"input")&&(b.input=a.input));y.push(a);Q.push(b);(d?B:C)(a,function(a,q){b[q]=Ca(a,h,k,n,y,Q)});f&&(w(y),w(Q));return b}function qa(a){var h=[];Z(a,function(a,q){T(a)&&
h.push(q)});return h.sort()}function Ya(a){for(var h=-1,k=L(a),q=k.length,c={};++h<q;){var b=k[h];c[a[b]]=b}return c}function ca(a,h,k,q,c,b){var f=k===A;if("function"==typeof k&&!f){k=g.createCallback(k,q,2);var d=k(a,h);if("undefined"!=typeof d)return!!d}if(a===h)return 0!==a||1/a==1/h;var e=typeof a,n=typeof h;if(a===a&&(!a||"function"!=e&&"object"!=e)&&(!h||"function"!=n&&"object"!=n))return!1;if(null==a||null==h)return a===h;n=F.call(a);e=F.call(h);n==ja&&(n=U);e==ja&&(e=U);if(n!=e)return!1;
switch(n){case fa:case ga:return+a==+h;case ha:return a!=+a?h!=+h:0==a?1/a==1/h:a==+h;case ia:case ba:return a==S(h)}e=n==ra;if(!e){if(E.call(a,"__wrapped__ ")||E.call(h,"__wrapped__"))return ca(a.__wrapped__||a,h.__wrapped__||h,k,q,c,b);if(n!=U)return!1;var n=a.constructor,l=h.constructor;if(n!=l&&!(T(n)&&n instanceof n&&T(l)&&l instanceof l))return!1}l=!c;c||(c=t());b||(b=t());for(n=c.length;n--;)if(c[n]==a)return b[n]==h;var r=0,d=!0;c.push(a);b.push(h);if(e){n=a.length;r=h.length;d=r==a.length;
if(!d&&!f)return d;for(;r--;)if(e=n,l=h[r],f)for(;e--&&!(d=ca(a[e],l,k,q,c,b)););else if(!(d=ca(a[r],l,k,q,c,b)))break;return d}Z(h,function(h,g,f){if(E.call(f,g))return r++,d=E.call(a,g)&&ca(a[g],h,k,q,c,b)});d&&!f&&Z(a,function(h,a,k){if(E.call(k,a))return d=-1<--r});l&&(w(c),w(b));return d}function T(a){return"function"==typeof a}function M(a){return!(!a||!I[typeof a])}function Za(a){return"number"==typeof a||F.call(a)==ha}function ka(a){return"string"==typeof a||F.call(a)==ba}function $a(a,h,
k){var q=arguments,c=0,b=2;if(!M(a))return a;if(k===A)var f=q[3],d=q[4],e=q[5];else{var n=!0,d=t(),e=t();"number"!=typeof k&&(b=q.length);3<b&&"function"==typeof q[b-2]?f=g.createCallback(q[--b-1],q[b--],2):2<b&&"function"==typeof q[b-1]&&(f=q[--b])}for(;++c<b;)(K(q[c])?B:C)(q[c],function(h,k){var c,q,y=h,b=a[k];if(h&&((q=K(h))||Ea(h))){for(y=d.length;y--;)if(c=d[y]==h){b=e[y];break}if(!c){var g;f&&(y=f(b,h),g="undefined"!=typeof y)&&(b=y);g||(b=q?K(b)?b:[]:Ea(b)?b:{});d.push(h);e.push(b);g||(b=$a(b,
h,A,f,d,e))}}else f&&(y=f(b,h),"undefined"==typeof y&&(y=h)),"undefined"!=typeof y&&(b=y);a[k]=b});n&&(w(d),w(e));return a}function Fa(a){for(var h=-1,k=L(a),c=k.length,y=G(c);++h<c;)y[h]=a[k[h]];return y}function ab(a,h,k){var c=-1,y=J(),b=a?a.length:0,g=!1;k=(0>k?O(0,b+k):k)||0;b&&"number"==typeof b?g=-1<(ka(a)?a.indexOf(h,k):y(a,h,k)):C(a,function(a){if(++c>=k)return!(g=a===h)});return g}function bb(a,h,k){var c=!0;h=g.createCallback(h,k);k=-1;var b=a?a.length:0;if("number"==typeof b)for(;++k<
b&&(c=!!h(a[k],k,a)););else C(a,function(a,k,b){return c=!!h(a,k,b)});return c}function sa(a,h,k){var c=[];h=g.createCallback(h,k);k=-1;var b=a?a.length:0;if("number"==typeof b)for(;++k<b;){var f=a[k];h(f,k,a)&&c.push(f)}else C(a,function(a,k,b){h(a,k,b)&&c.push(a)});return c}function Ga(a,h,k){h=g.createCallback(h,k);k=-1;var c=a?a.length:0;if("number"==typeof c)for(;++k<c;){var b=a[k];if(h(b,k,a))return b}else{var f;C(a,function(a,k,c){if(h(a,k,c))return f=a,!1});return f}}function B(a,h,k){var c=
-1,b=a?a.length:0;h=h&&"undefined"==typeof k?h:g.createCallback(h,k);if("number"==typeof b)for(;++c<b&&!1!==h(a[c],c,a););else C(a,h);return a}function Ha(a,h,k){var c=-1,b=a?a.length:0;h=g.createCallback(h,k);if("number"==typeof b)for(var f=G(b);++c<b;)f[c]=h(a[c],c,a);else f=[],C(a,function(a,k,b){f[++c]=h(a,k,b)});return f}function cb(a,h,k){var c=-Infinity,b=c;if(!h&&K(a)){k=-1;for(var f=a.length;++k<f;){var e=a[k];e>b&&(b=e)}}else h=!h&&ka(a)?d:g.createCallback(h,k),B(a,function(a,k,g){k=h(a,
k,g);k>c&&(c=k,b=a)});return b}function Ia(a,h){var k=-1,c=a?a.length:0;if("number"==typeof c)for(var b=G(c);++k<c;)b[k]=a[k][h];return b||Ha(a,h)}function Ja(a,h,k,c){if(!a)return k;var b=3>arguments.length;h=g.createCallback(h,c,4);var f=-1,d=a.length;if("number"==typeof d)for(b&&(k=a[++f]);++f<d;)k=h(k,a[f],f,a);else C(a,function(a,c,q){k=b?(b=!1,a):h(k,a,c,q)});return k}function db(a,h,k,c){var b=a?a.length:0,f=3>arguments.length;if("number"!=typeof b)var d=L(a),b=d.length;h=g.createCallback(h,
c,4);B(a,function(c,q,g){q=d?d[--b]:--b;k=f?(f=!1,a[q]):h(k,a[q],q,g)});return k}function eb(a,h,k){var c;h=g.createCallback(h,k);k=-1;var b=a?a.length:0;if("number"==typeof b)for(;++k<b&&!(c=h(a[k],k,a)););else C(a,function(a,k,b){return!(c=h(a,k,b))});return!!c}function fb(a){var h=-1,k=J(),c=a?a.length:0,g=da.apply(H,D.call(arguments,1)),f=[],d=c>=V&&k===b;if(d){var e=l(g);e?(k=m,g=e):d=!1}for(;++h<c;)e=a[h],0>k(g,e)&&f.push(e);d&&r(g);return f}function Ka(a,h,k){if(a){var b=0,f=a.length;if("number"!=
typeof h&&null!=h){var d=-1;for(h=g.createCallback(h,k);++d<f&&h(a[d],d,a);)b++}else if(b=h,null==b||k)return a[0];return c(a,0,ta(O(0,b),f))}}function Xa(a,h,k){if("number"==typeof k){var c=a?a.length:0;k=0>k?O(0,c+k):k||0}else if(k)return k=gb(a,h),a[k]===h?k:-1;return a?b(a,h,k):-1}function La(a,h,k){if("number"!=typeof h&&null!=h){var b=0,f=-1,d=a?a.length:0;for(h=g.createCallback(h,k);++f<d&&h(a[f],f,a);)b++}else b=null==h||k?1:O(0,h);return c(a,b)}function gb(a,h,k,c){var b=0,f=a?a.length:b;
k=k?g.createCallback(k,c,1):Ma;for(h=k(h);b<f;)c=b+f>>>1,k(a[c])<h?b=c+1:f=c;return b}function hb(a){for(var h=-1,k=a?cb(Ia(a,"length")):0,c=G(0>k?0:k);++h<k;)c[h]=Ia(a,h);return c}function ib(a,h){for(var k=-1,c=a?a.length:0,b={};++k<c;){var f=a[k];h?b[f]=h[k]:b[f[0]]=f[1]}return b}function Na(a,h){return jb.fastBind||W&&2<arguments.length?W.call.apply(W,arguments):Y(a,h,D.call(arguments,2))}function kb(a,h,k){function c(){ua(s);ua(m);n=0;s=m=null}function b(){var h=t&&(!V||1<n);c();h&&(!1!==r&&
(l=new va),d=a.apply(e,g))}function f(){c();if(t||r!==h)l=new va,d=a.apply(e,g)}var g,d,e,n=0,l=0,r=!1,s=null,m=null,t=!0;h=O(0,h||0);if(!0===k)var V=!0,t=!1;else M(k)&&(V=k.leading,r="maxWait"in k&&O(h,k.maxWait||0),t="trailing"in k?k.trailing:t);return function(){g=arguments;e=this;n++;ua(m);if(!1===r)V&&2>n&&(d=a.apply(e,g));else{var k=new va;s||V||(l=k);var c=r-(k-l);0>=c?(ua(s),s=null,l=k,d=a.apply(e,g)):s||(s=wa(f,c))}h!==r&&(m=wa(b,h));return d}}function lb(a){var h=D.call(arguments,1);return wa(function(){a.apply(n,
h)},1)}function Ma(a){return a}function mb(a){B(qa(a),function(h){var k=g[h]=a[h];g.prototype[h]=function(){var a=this.__wrapped__,h=[a];xa.apply(h,arguments);h=k.apply(g,h);return a&&"object"==typeof a&&a===h?this:new u(h)}})}function nb(){return this.__wrapped__}e=e?X.defaults(a.Object(),e,X.pick(a,xb)):a;var G=e.Array,la=e.Boolean,va=e.Date,Oa=e.Function,P=e.Math,yb=e.Number,ma=e.Object,Pa=e.RegExp,S=e.String,tb=e.TypeError,H=[],Qa=ma.prototype,zb=e._,ea=Pa("^"+S(Qa.valueOf).replace(/[.*+?^${}()|[\]\\]/g,
"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Ab=P.ceil,ua=e.clearTimeout,da=H.concat,ob=P.floor,Bb=Oa.prototype.toString,na=ea.test(na=ma.getPrototypeOf)&&na,E=Qa.hasOwnProperty,xa=H.push,ya=e.setImmediate,wa=e.setTimeout,F=Qa.toString,W=ea.test(W=F.bind)&&W,pa=ea.test(pa=ma.create)&&pa,Ra=ea.test(Ra=G.isArray)&&Ra,Cb=e.isFinite,Db=e.isNaN,za=ea.test(za=ma.keys)&&za,O=P.max,ta=P.min,Sa=e.parseInt,pb=P.random,D=H.slice,P=ea.test(e.attachEvent),P=W&&!/\n|true/.test(W+P),R={};R[ra]=G;R[fa]=la;R[ga]=
va;R[qb]=Oa;R[U]=ma;R[ha]=yb;R[ia]=Pa;R[ba]=S;u.prototype=g.prototype;var jb=g.support={};jb.fastBind=W&&!P;g.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:rb,variable:"",imports:{_:g}};var K=Ra,la=function(a){var h,k=[];if(!a||!I[typeof a])return k;for(h in a)E.call(a,h)&&k.push(h);return k},L=za?function(a){return M(a)?za(a):[]}:la,Wa={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},vb=Ya(Wa),Da=function(a,h,k){var c,b=a,f=b;if(!b)return f;var d=
arguments,e=0,n="number"==typeof k?2:d.length;if(3<n&&"function"==typeof d[n-2])var l=g.createCallback(d[--n-1],d[n--],2);else 2<n&&"function"==typeof d[n-1]&&(l=d[--n]);for(;++e<n;)if((b=d[e])&&I[typeof b])for(var r=-1,s=I[typeof b]&&L(b),m=s?s.length:0;++r<m;)c=s[r],f[c]=l?l(f[c],b[c]):b[c];return f},Ta=function(a,h,k){var c,b=a,f=b;if(!b)return f;for(var g=arguments,d=0,e="number"==typeof k?2:g.length;++d<e;)if((b=g[d])&&I[typeof b])for(var n=-1,l=I[typeof b]&&L(b),r=l?l.length:0;++n<r;)c=l[n],
"undefined"==typeof f[c]&&(f[c]=b[c]);return f},Z=function(a,h,c){var b;if(!a||!I[typeof a])return a;h=h&&"undefined"==typeof c?h:g.createCallback(h,c);for(b in a)if(!1===h(a[b],b,a))break;return a},C=function(a,h,c){if(!a||!I[typeof a])return a;h=h&&"undefined"==typeof c?h:g.createCallback(h,c);for(var b=-1,f=I[typeof a]&&L(a),d=f?f.length:0;++b<d&&(c=f[b],!1!==h(a[c],c,a)););return a},Ea=function(a){if(!a||F.call(a)!=U)return!1;var h=a.valueOf,c="function"==typeof h&&(c=na(h))&&na(c);return c?a==
c||na(a)==c:Ba(a)},la=$(function h(a,c,b){for(var f=-1,g=a?a.length:0,d=[];++f<g;){var e=a[f];b&&(e=b(e,f,a));K(e)?xa.apply(d,c?e:h(e)):d.push(e)}return d}),Ua=$(function(a,c,f){var g=-1,d=J(),e=a?a.length:0,n=[],s=!c&&e>=V&&d===b,u=f||s?t():n;if(s){var A=l(u);A?(d=m,u=A):(s=!1,u=f?u:(w(u),n))}for(;++g<e;){var A=a[g],p=f?f(A,g,a):A;if(c?!g||u[u.length-1]!==p:0>d(u,p))(f||s)&&u.push(p),n.push(A)}s?(w(u.array),r(u)):f&&w(u);return n});P&&(Va&&"function"==typeof ya)&&(lb=Na(ya,e));ya=8==Sa(sb+"08")?
Sa:function(a,c){return Sa(ka(a)?a.replace(Eb,""):a,c||0)};g.after=function(a,c){return 1>a?c():function(){if(1>--a)return c.apply(this,arguments)}};g.assign=Da;g.at=function(a){for(var c=-1,b=da.apply(H,D.call(arguments,1)),f=b.length,g=G(f);++c<f;)g[c]=a[b[c]];return g};g.bind=Na;g.bindAll=function(a){for(var c=1<arguments.length?da.apply(H,D.call(arguments,1)):qa(a),b=-1,f=c.length;++b<f;){var g=c[b];a[g]=Na(a[g],a)}return a};g.bindKey=function(a,c){return Y(a,c,D.call(arguments,2),A)};g.compact=
function(a){for(var c=-1,b=a?a.length:0,f=[];++c<b;){var g=a[c];g&&f.push(g)}return f};g.compose=function(){var a=arguments;return function(){for(var c=arguments,b=a.length;b--;)c=[a[b].apply(this,c)];return c[0]}};g.countBy=function(a,c,b){var f={};c=g.createCallback(c,b);B(a,function(a,h,b){h=S(c(a,h,b));E.call(f,h)?f[h]++:f[h]=1});return f};g.createCallback=function(a,c,b){if(null==a)return Ma;var f=typeof a;if("function"!=f){if("object"!=f)return function(c){return c[a]};var g=L(a);return function(c){for(var b=
g.length,k=!1;b--&&(k=ca(c[g[b]],a[g[b]],A)););return k}}return"undefined"==typeof c||oa&&!oa.test(Bb.call(a))?a:1===b?function(b){return a.call(c,b)}:2===b?function(b,f){return a.call(c,b,f)}:4===b?function(b,f,g,d){return a.call(c,b,f,g,d)}:function(b,f,g){return a.call(c,b,f,g)}};g.debounce=kb;g.defaults=Ta;g.defer=lb;g.delay=function(a,c){var b=D.call(arguments,2);return wa(function(){a.apply(n,b)},c)};g.difference=fb;g.filter=sa;g.flatten=la;g.forEach=B;g.forIn=Z;g.forOwn=C;g.functions=qa;g.groupBy=
function(a,c,b){var f={};c=g.createCallback(c,b);B(a,function(a,h,b){h=S(c(a,h,b));(E.call(f,h)?f[h]:f[h]=[]).push(a)});return f};g.initial=function(a,b,f){if(!a)return[];var d=0,e=a.length;if("number"!=typeof b&&null!=b){var n=e;for(b=g.createCallback(b,f);n--&&b(a[n],n,a);)d++}else d=null==b||f?1:b||d;return c(a,0,ta(O(0,e-d),e))};g.intersection=function(a){for(var c=arguments,f=c.length,g=-1,d=t(),e=-1,n=J(),s=a?a.length:0,u=[],A=t();++g<f;){var p=c[g];d[g]=n===b&&(p?p.length:0)>=V&&l(g?c[g]:A)}a:for(;++e<
s;){var v=d[0],p=a[e];if(0>(v?m(v,p):n(A,p))){g=f;for((v||A).push(p);--g;)if(v=d[g],0>(v?m(v,p):n(c[g],p)))continue a;u.push(p)}}for(;f--;)(v=d[f])&&r(v);w(d);w(A);return u};g.invert=Ya;g.invoke=function(a,c){var b=D.call(arguments,2),f=-1,g="function"==typeof c,d=a?a.length:0,e=G("number"==typeof d?d:0);B(a,function(a){e[++f]=(g?c:a[c]).apply(a,b)});return e};g.keys=L;g.map=Ha;g.max=cb;g.memoize=function(a,c){function b(){var f=b.cache,g=aa+(c?c.apply(this,arguments):arguments[0]);return E.call(f,
g)?f[g]:f[g]=a.apply(this,arguments)}b.cache={};return b};g.merge=$a;g.min=function(a,c,b){var f=Infinity,e=f;if(!c&&K(a)){b=-1;for(var n=a.length;++b<n;){var l=a[b];l<e&&(e=l)}}else c=!c&&ka(a)?d:g.createCallback(c,b),B(a,function(a,h,b){h=c(a,h,b);h<f&&(f=h,e=a)});return e};g.omit=function(a,c,b){var f=J(),d="function"==typeof c,e={};if(d)c=g.createCallback(c,b);else var n=da.apply(H,D.call(arguments,1));Z(a,function(a,h,b){if(d?!c(a,h,b):0>f(n,h))e[h]=a});return e};g.once=function(a){var c,b;return function(){if(c)return b;
c=!0;b=a.apply(this,arguments);a=null;return b}};g.pairs=function(a){for(var c=-1,b=L(a),f=b.length,g=G(f);++c<f;){var d=b[c];g[c]=[d,a[d]]}return g};g.partial=function(a){return Y(a,D.call(arguments,1))};g.partialRight=function(a){return Y(a,D.call(arguments,1),null,A)};g.pick=function(a,c,b){var f={};if("function"!=typeof c)for(var d=-1,e=da.apply(H,D.call(arguments,1)),n=M(a)?e.length:0;++d<n;){var l=e[d];l in a&&(f[l]=a[l])}else c=g.createCallback(c,b),Z(a,function(a,b,h){c(a,b,h)&&(f[b]=a)});
return f};g.pluck=Ia;g.range=function(a,c,b){a=+a||0;b=+b||1;null==c&&(c=a,a=0);var f=-1;c=O(0,Ab((c-a)/b));for(var g=G(c);++f<c;)g[f]=a,a+=b;return g};g.reject=function(a,c,b){c=g.createCallback(c,b);return sa(a,function(a,b,h){return!c(a,b,h)})};g.rest=La;g.shuffle=function(a){var c=-1,b=a?a.length:0,f=G("number"==typeof b?b:0);B(a,function(a){var b=ob(pb()*(++c+1));f[c]=f[b];f[b]=a});return f};g.sortBy=function(a,c,b){var f=-1,d=a?a.length:0,e=G("number"==typeof d?d:0);c=g.createCallback(c,b);
B(a,function(a,b,h){var g=e[++f]=x();g.criteria=c(a,b,h);g.index=f;g.value=a});d=e.length;for(e.sort(p);d--;)a=e[d],e[d]=a.value,r(a);return e};g.tap=function(a,c){c(a);return a};g.throttle=function(a,c,b){var f=!0,g=!0;!1===b?f=!1:M(b)&&(f="leading"in b?b.leading:f,g="trailing"in b?b.trailing:g);b=x();b.leading=f;b.maxWait=c;b.trailing=g;a=kb(a,c,b);r(b);return a};g.times=function(a,c,b){a=-1<(a=+a)?a:0;var f=-1,d=G(a);for(c=g.createCallback(c,b,1);++f<a;)d[f]=c(f);return d};g.toArray=function(a){return a&&
"number"==typeof a.length?c(a):Fa(a)};g.transform=function(a,c,b,f){var d=K(a);c=g.createCallback(c,f,4);null==b&&(d?b=[]:(f=(f=a&&a.constructor)&&f.prototype,b=M(f)?pa(f):{}));(d?B:C)(a,function(a,h,f){return c(b,a,h,f)});return b};g.union=function(a){K(a)||(arguments[0]=a?D.call(a):H);return Ua(da.apply(H,arguments))};g.uniq=Ua;g.unzip=hb;g.values=Fa;g.where=sa;g.without=function(a){return fb(a,D.call(arguments,1))};g.wrap=function(a,c){return function(){var b=[a];xa.apply(b,arguments);return c.apply(this,
b)}};g.zip=function(a){return a?hb(arguments):[]};g.zipObject=ib;g.collect=Ha;g.drop=La;g.each=B;g.extend=Da;g.methods=qa;g.object=ib;g.select=sa;g.tail=La;g.unique=Ua;mb(g);g.chain=g;g.prototype.chain=function(){return this};g.clone=Ca;g.cloneDeep=function(a,c,b){return Ca(a,!0,c,b)};g.contains=ab;g.escape=function(a){return null==a?"":S(a).replace(Fb,z)};g.every=bb;g.find=Ga;g.findIndex=function(a,c,b){var f=-1,d=a?a.length:0;for(c=g.createCallback(c,b);++f<d;)if(c(a[f],f,a))return f;return-1};
g.findKey=function(a,c,b){var f;c=g.createCallback(c,b);C(a,function(a,b,h){if(c(a,b,h))return f=b,!1});return f};g.has=function(a,c){return a?E.call(a,c):!1};g.identity=Ma;g.indexOf=Xa;g.isArguments=function(a){return F.call(a)==ja};g.isArray=K;g.isBoolean=function(a){return!0===a||!1===a||F.call(a)==fa};g.isDate=function(a){return a?"object"==typeof a&&F.call(a)==ga:!1};g.isElement=function(a){return a?1===a.nodeType:!1};g.isEmpty=function(a){var c=!0;if(!a)return c;var b=F.call(a),f=a.length;if(b==
ra||(b==ba||b==ja)||b==U&&"number"==typeof f&&T(a.splice))return!f;C(a,function(){return c=!1});return c};g.isEqual=ca;g.isFinite=function(a){return Cb(a)&&!Db(parseFloat(a))};g.isFunction=T;g.isNaN=function(a){return Za(a)&&a!=+a};g.isNull=function(a){return null===a};g.isNumber=Za;g.isObject=M;g.isPlainObject=Ea;g.isRegExp=function(a){return a?"object"==typeof a&&F.call(a)==ia:!1};g.isString=ka;g.isUndefined=function(a){return"undefined"==typeof a};g.lastIndexOf=function(a,c,b){var f=a?a.length:
0;for("number"==typeof b&&(f=(0>b?O(0,f+b):ta(b,f-1))+1);f--;)if(a[f]===c)return f;return-1};g.mixin=mb;g.noConflict=function(){e._=zb;return this};g.parseInt=ya;g.random=function(a,c){null==a&&null==c&&(c=1);a=+a||0;null==c?(c=a,a=0):c=+c||0;var b=pb();return a%1||c%1?a+ta(b*(c-a+parseFloat("1e-"+((b+"").length-1))),c):a+ob(b*(c-a+1))};g.reduce=Ja;g.reduceRight=db;g.result=function(a,c){var b=a?a[c]:n;return T(b)?a[c]():b};g.runInContext=f;g.size=function(a){var c=a?a.length:0;return"number"==typeof c?
c:L(a).length};g.some=eb;g.sortedIndex=gb;g.template=function(a,c,b){var f=g.templateSettings;a||(a="");b=Ta({},b,f);var d=Ta({},b.imports,f.imports),f=L(d),d=Fa(d),e,l=0,r=b.interpolate||Aa,s="__p += '",r=Pa((b.escape||Aa).source+"|"+r.source+"|"+(r===rb?Gb:Aa).source+"|"+(b.evaluate||Aa).source+"|$","g");a.replace(r,function(c,b,f,g,d,k){f||(f=g);s+=a.slice(l,k).replace(Hb,v);b&&(s+="' +\n__e("+b+") +\n'");d&&(e=!0,s+="';\n"+d+";\n__p += '");f&&(s+="' +\n((__t = ("+f+")) == null ? '' : __t) +\n'");
l=k+c.length;return c});var s=s+"';\n",m=r=b.variable;m||(r="obj",s="with ("+r+") {\n"+s+"\n}\n");s=(e?s.replace(Ib,""):s).replace(Jb,"$1").replace(Kb,"$1;");s="function("+r+") {\n"+(m?"":r+" || ("+r+" = {});\n")+"var __t, __p = '', __e = _.escape"+(e?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+s+"return __p\n}";b="\n/*\n//@ sourceURL="+(b.sourceURL||"/lodash/template/source["+Lb++ +"]")+"\n*/";try{var u=Oa(f,"return "+s+b).apply(n,d)}catch(t){throw t.source=
s,t;}if(c)return u(c);u.source=s;return u};g.unescape=function(a){return null==a?"":S(a).replace(Mb,ub)};g.uniqueId=function(a){var c=++s;return S(null==a?"":a)+c};g.all=bb;g.any=eb;g.detect=Ga;g.findWhere=Ga;g.foldl=Ja;g.foldr=db;g.include=ab;g.inject=Ja;C(g,function(a,c){g.prototype[c]||(g.prototype[c]=function(){var c=[this.__wrapped__];xa.apply(c,arguments);return a.apply(g,c)})});g.first=Ka;g.last=function(a,b,f){if(a){var d=0,e=a.length;if("number"!=typeof b&&null!=b){var n=e;for(b=g.createCallback(b,
f);n--&&b(a[n],n,a);)d++}else if(d=b,null==d||f)return a[e-1];return c(a,O(0,e-d))}};g.take=Ka;g.head=Ka;C(g,function(a,c){g.prototype[c]||(g.prototype[c]=function(c,b){var f=a(this.__wrapped__,c,b);return null==c||b&&"function"!=typeof c?f:new u(f)})});g.VERSION="1.3.1";g.prototype.toString=function(){return S(this.__wrapped__)};g.prototype.value=nb;g.prototype.valueOf=nb;B(["join","pop","shift"],function(a){var c=H[a];g.prototype[a]=function(){return c.apply(this.__wrapped__,arguments)}});B(["push",
"reverse","sort","unshift"],function(a){var c=H[a];g.prototype[a]=function(){c.apply(this.__wrapped__,arguments);return this}});B(["concat","slice","splice"],function(a){var c=H[a];g.prototype[a]=function(){return new u(c.apply(this.__wrapped__,arguments))}});return g}var n,u=[],z=[],s=0,A={},aa=+new Date+"",V=75,Y=40,Ib=/\b__p \+= '';/g,Jb=/\b(__p \+=) '' \+/g,Kb=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Mb=/&(?:amp|lt|gt|quot|#39);/g,Gb=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,wb=/\w*$/,rb=/<%=([\s\S]+?)%>/g,oa=
(oa=/\bthis\b/)&&oa.test(f)&&oa,sb=" \t\x0B\f\u00a0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000",Eb=RegExp("^["+sb+"]*0+(?=.$)"),Aa=/($^)/,Fb=/[&<>"']/g,Hb=/['\n\r\t\u2028\u2029\\]/g,xb="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setImmediate setTimeout".split(" "),Lb=0,ja="[object Arguments]",ra="[object Array]",fa="[object Boolean]",ga="[object Date]",qb=
"[object Function]",ha="[object Number]",U="[object Object]",ia="[object RegExp]",ba="[object String]",N={};N[qb]=!1;N[ja]=N[ra]=N[fa]=N[ga]=N[ha]=N[U]=N[ia]=N[ba]=!0;var I={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Ba={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},$=I[typeof exports]&&exports,Va=I[typeof module]&&module&&module.exports==$&&module,J=I[typeof global]&&global;!J||J.global!==J&&J.window!==J||(a=J);var X=f();"function"==typeof define&&
"object"==typeof define.amd&&define.amd?(a._=X,define(function(){return X})):$&&!$.nodeType?Va?(Va.exports=X)._=X:$._=X:a._=X})(this);!function(){function a(a){this.s=null!==a&&void 0!==a?"string"===typeof a?a:a.toString():a;this.orig=a;null!==a&&void 0!==a?this.__defineGetter__?this.__defineGetter__("length",function(){return this.s.length}):this.length=a.length:this.length=-1}function b(c){return new a(c)}function m(a,b){var d=[],e;for(e=0;e<a.length;e++)d.push(a[e]),b&&b.call(a,a[e],e);return d}var e={},d=String.prototype,p=a.prototype={between:function(c,b){var d=this.s,e=d.indexOf(c),l=d.indexOf(b),s=e+c.length;return new a(l>
e?d.slice(s,l):"")},camelize:function(){var c=this.trim().s.replace(/(\-|_|\s)+(.)?/g,function(a,c,b){return b?b.toUpperCase():""});return new a(c)},capitalize:function(){return new a(this.s.substr(0,1).toUpperCase()+this.s.substring(1).toLowerCase())},charAt:function(a){return this.s.charAt(a)},chompLeft:function(c){var b=this.s;return 0===b.indexOf(c)?(b=b.slice(c.length),new a(b)):this},chompRight:function(c){if(this.endsWith(c)){var b=this.s,b=b.slice(0,b.length-c.length);return new a(b)}return this},
collapseWhitespace:function(){var c=this.s.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"");return new a(c)},contains:function(a){return 0<=this.s.indexOf(a)},count:function(a){for(var b=0,d=this.s.indexOf(a);0<=d;)b+=1,d=this.s.indexOf(a,d+1);return b},dasherize:function(){var c=this.trim().s.replace(/[_\s]+/g,"-").replace(/([A-Z])/g,"-$1").replace(/-+/g,"-").toLowerCase();return new a(c)},decodeHtmlEntities:function(){var c=this.s,c=c.replace(/&#(\d+);?/g,function(a,c){return String.fromCharCode(c)}).replace(/&#[xX]([A-Fa-f0-9]+);?/g,
function(a,c){return String.fromCharCode(parseInt(c,16))}).replace(/&([^;\W]+;?)/g,function(a,c){var b=c.replace(/;$/,""),b=e[c]||c.match(/;$/)&&e[b];return"number"===typeof b?String.fromCharCode(b):"string"===typeof b?b:a});return new a(c)},endsWith:function(a){var b=this.s.length-a.length;return 0<=b&&this.s.indexOf(a,b)===b},escapeHTML:function(){return new a(this.s.replace(/[&<>"']/g,function(a){return"&"+w[a]+";"}))},ensureLeft:function(c){var b=this.s;return 0===b.indexOf(c)?this:new a(c+b)},
ensureRight:function(c){var b=this.s;return this.endsWith(c)?this:new a(b+c)},humanize:function(){if(null===this.s||void 0===this.s)return new a("");var c=this.underscore().replace(/_id$/,"").replace(/_/g," ").trim().capitalize();return new a(c)},isAlpha:function(){return!/[^a-z\xC0-\xFF]/.test(this.s.toLowerCase())},isAlphaNumeric:function(){return!/[^0-9a-z\xC0-\xFF]/.test(this.s.toLowerCase())},isEmpty:function(){return null===this.s||void 0===this.s?!0:/^[\s\xa0]*$/.test(this.s)},isLower:function(){return this.isAlpha()&&
this.s.toLowerCase()===this.s},isNumeric:function(){return!/[^0-9]/.test(this.s)},isUpper:function(){return this.isAlpha()&&this.s.toUpperCase()===this.s},left:function(c){return 0<=c?(c=this.s.substr(0,c),new a(c)):this.right(-c)},lines:function(){return this.replaceAll("\r\n","\n").s.split("\n")},pad:function(c,b){b=b||" ";if(this.s.length>=c)return new a(this.s);c-=this.s.length;var d=Array(Math.ceil(c/2)+1).join(b),e=Array(Math.floor(c/2)+1).join(b);return new a(d+this.s+e)},padLeft:function(c,
b){b=b||" ";return this.s.length>=c?new a(this.s):new a(Array(c-this.s.length+1).join(b)+this.s)},padRight:function(c,b){b=b||" ";return this.s.length>=c?new a(this.s):new a(this.s+Array(c-this.s.length+1).join(b))},parseCSV:function(a,b,d,e){a=a||",";d=d||"\\";"undefined"==typeof b&&(b='"');var l=0,s=[],r=[],m=this.s.length,t=!1;if("undefined"!==typeof e)var p=[];for(b||(t=!0);l<m;){var v=this.s.charAt(l);switch(v){case d:if(t&&(d!==b||this.s.charAt(l+1)===b)){l+=1;s.push(this.s.charAt(l));break}if(d!==
b)break;case b:t=!t;break;case a:t&&b?s.push(v):(r.push(s.join("")),s.length=0);break;case e:t?s.push(v):p&&(r.push(s.join("")),p.push(r),r=[],s.length=0);break;default:t&&s.push(v)}l+=1}r.push(s.join(""));return p?(p.push(r),p):r},replaceAll:function(b,f){var d=this.s.split(b).join(f);return new a(d)},right:function(b){return 0<=b?(b=this.s.substr(this.s.length-b,b),new a(b)):this.left(-b)},slugify:function(){var b=(new a(this.s.replace(/[^\w\s-]/g,"").toLowerCase())).dasherize().s;"-"===b.charAt(0)&&
(b=b.substr(1));return new a(b)},startsWith:function(a){return 0===this.s.lastIndexOf(a,0)},stripPunctuation:function(){return new a(this.s.replace(/[^\w\s]|_/g,"").replace(/\s+/g," "))},stripTags:function(){var b=this.s;m(0<arguments.length?arguments:[""],function(a){b=b.replace(RegExp("</?"+a+"[^<>]*>","gi"),"")});return new a(b)},template:function(c,f,d){var e=this.s;f=f||b.TMPL_OPEN;d=d||b.TMPL_CLOSE;(e.match(RegExp(f+"(.+?)"+d,"g"))||[]).forEach(function(a){var b=a.substring(f.length,a.length-
d.length);c[b]&&(e=e.replace(a,c[b]))});return new a(e)},times:function(b){return new a(Array(b+1).join(this.s))},toBoolean:function(){if("string"===typeof this.orig){var a=this.s.toLowerCase();return"true"===a||"yes"===a||"on"===a}return!0===this.orig||1===this.orig},toFloat:function(a){var b=parseFloat(this.s);return a?parseFloat(b.toFixed(a)):b},toInt:function(){return/^\s*-?0x/i.test(this.s)?parseInt(this.s,16):parseInt(this.s,10)},trim:function(){var b;b="undefined"===typeof d.trim?this.s.replace(/(^\s*|\s*$)/g,
""):this.s.trim();return new a(b)},trimLeft:function(){var b;b=d.trimLeft?this.s.trimLeft():this.s.replace(/(^\s*)/g,"");return new a(b)},trimRight:function(){var b;b=d.trimRight?this.s.trimRight():this.s.replace(/\s+$/,"");return new a(b)},truncate:function(b,f){var d=this.s;b=~~b;f=f||"...";if(d.length<=b)return new a(d);var e=d.slice(0,b+1).replace(/.(?=\W*\w*$)/g,function(a){return a.toUpperCase()!==a.toLowerCase()?"A":" "}),e=e.slice(e.length-2).match(/\w\w/)?e.replace(/\s*\S+$/,""):(new a(e.slice(0,
e.length-1))).trimRight().s;return(e+f).length>d.length?new a(d):new a(d.slice(0,e.length)+f)},toCSV:function(b,f){var d=",",e='"',l="\\",r=!0,m=!1,t=[];"object"===typeof b?(d=b.delimiter||d,d=b.separator||d,e=b.qualifier||e,r=!!b.encloseNumbers,l=b.escape||l,m=!!b.keys):"string"===typeof b&&(d=b);"string"===typeof f&&(e=f);null===f&&(e=null);if(this.orig instanceof Array)t=this.orig;else for(var p in this.orig)this.orig.hasOwnProperty(p)&&(m?t.push(p):t.push(this.orig[p]));l+=e;m=[];for(p=0;p<t.length;++p){var v=
null!==e&&""!==e;"number"==typeof t[p]&&(v&=r);v&&m.push(e);if(null!==t[p]&&void 0!==t[p]){var x=(new a(t[p])).replaceAll(e,l).s;m.push(x)}else m.push("");v&&m.push(e);d&&m.push(d)}m.length-=1;return new a(m.join(""))},toString:function(){return this.s},underscore:function(){var b=this.trim().s.replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase();(new a(this.s.charAt(0))).isUpper()&&(b="_"+b);return new a(b)},unescapeHTML:function(){return new a(this.s.replace(/\&([^;]+);/g,
function(a,b){var d;return b in x?x[b]:(d=b.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(d[1],16)):(d=b.match(/^#(\d+)$/))?String.fromCharCode(~~d[1]):a}))},valueOf:function(){return this.s.valueOf()}},l=[],v=function(){var a;a=[];if(Object.getOwnPropertyNames)a=Object.getOwnPropertyNames(d),a.splice(a.indexOf("valueOf"),1),a.splice(a.indexOf("toString"),1);else{var b={},e;for(e in String.prototype)b[e]=e;for(e in Object.prototype)delete b[e];for(e in b)a.push(e)}b={};for(e=0;e<a.length;++e){var l=
a[e],r=d[l];try{var s=typeof r.apply("teststring",[]);b[l]=s}catch(m){}}return b}(),t;for(t in v)(function(b){var f=d[b];"function"==typeof f&&(p[b]||(p[b]="string"===v[b]?function(){return new a(f.apply(this,arguments))}:f))})(t);p.repeat=p.times;p.include=p.contains;p.toInteger=p.toInt;p.toBool=p.toBoolean;p.decodeHTMLEntities=p.decodeHtmlEntities;b.extendPrototype=function(){for(var a in p)(function(a){var b=p[a];d.hasOwnProperty(a)||(l.push(a),d[a]=function(){String.prototype.s=this;return b.apply(this,
arguments)})})(a)};b.restorePrototype=function(){for(var a=0;a<l.length;++a)delete String.prototype[l[a]];l.length=0};b.VERSION="1.5.0";b.TMPL_OPEN="{{";b.TMPL_CLOSE="}}";b.ENTITIES=e;"undefined"!==typeof module&&"undefined"!==typeof module.exports?module.exports=b:"function"===typeof define&&define.amd?define([],function(){return b}):window.S=b;var x={lt:"<",gt:">",quot:'"',apos:"'",amp:"&"},w={},r;for(r in x)w[x[r]]=r;e={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,
Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,
ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,"OElig;":338,"oelig;":339,"Scaron;":352,"scaron;":353,"Yuml;":376,"fnof;":402,"circ;":710,
"tilde;":732,"Alpha;":913,"Beta;":914,"Gamma;":915,"Delta;":916,"Epsilon;":917,"Zeta;":918,"Eta;":919,"Theta;":920,"Iota;":921,"Kappa;":922,"Lambda;":923,"Mu;":924,"Nu;":925,"Xi;":926,"Omicron;":927,"Pi;":928,"Rho;":929,"Sigma;":931,"Tau;":932,"Upsilon;":933,"Phi;":934,"Chi;":935,"Psi;":936,"Omega;":937,"alpha;":945,"beta;":946,"gamma;":947,"delta;":948,"epsilon;":949,"zeta;":950,"eta;":951,"theta;":952,"iota;":953,"kappa;":954,"lambda;":955,"mu;":956,"nu;":957,"xi;":958,"omicron;":959,"pi;":960,
"rho;":961,"sigmaf;":962,"sigma;":963,"tau;":964,"upsilon;":965,"phi;":966,"chi;":967,"psi;":968,"omega;":969,"thetasym;":977,"upsih;":978,"piv;":982,"ensp;":8194,"emsp;":8195,"thinsp;":8201,"zwnj;":8204,"zwj;":8205,"lrm;":8206,"rlm;":8207,"ndash;":8211,"mdash;":8212,"lsquo;":8216,"rsquo;":8217,"sbquo;":8218,"ldquo;":8220,"rdquo;":8221,"bdquo;":8222,"dagger;":8224,"Dagger;":8225,"bull;":8226,"hellip;":8230,"permil;":8240,"prime;":8242,"Prime;":8243,"lsaquo;":8249,"rsaquo;":8250,"oline;":8254,"frasl;":8260,
"euro;":8364,"image;":8465,"weierp;":8472,"real;":8476,"trade;":8482,"alefsym;":8501,"larr;":8592,"uarr;":8593,"rarr;":8594,"darr;":8595,"harr;":8596,"crarr;":8629,"lArr;":8656,"uArr;":8657,"rArr;":8658,"dArr;":8659,"hArr;":8660,"forall;":8704,"part;":8706,"exist;":8707,"empty;":8709,"nabla;":8711,"isin;":8712,"notin;":8713,"ni;":8715,"prod;":8719,"sum;":8721,"minus;":8722,"lowast;":8727,"radic;":8730,"prop;":8733,"infin;":8734,"ang;":8736,"and;":8743,"or;":8744,"cap;":8745,"cup;":8746,"int;":8747,
"there4;":8756,"sim;":8764,"cong;":8773,"asymp;":8776,"ne;":8800,"equiv;":8801,"le;":8804,"ge;":8805,"sub;":8834,"sup;":8835,"nsub;":8836,"sube;":8838,"supe;":8839,"oplus;":8853,"otimes;":8855,"perp;":8869,"sdot;":8901,"lceil;":8968,"rceil;":8969,"lfloor;":8970,"rfloor;":8971,"lang;":9001,"rang;":9002,"loz;":9674,"spades;":9824,"clubs;":9827,"hearts;":9829,"diams;":9830}}.call(this);(function(){this.H={Check:{},TennisScoreKeeper:{}}}).call(this);(function(a){function b(b){return b===a||null===b}function m(a){this.isBetweenInclusive=function(b,e){return a>=b&&a<=e};this.isBetweenExclusive=function(b,e){return a>b&&a<e}}function e(a,b){var l=typeof a,m=typeof b;if(null===a&&null===b)return!0;if(l!==m)return!1;if("object"!==l&&"object"!==m)return a==b;var l=!0,t;for(t in a)if("function"!==typeof a[t]&&(l=l&&e(a[t],b[t]),!l))return!1;return!0}this.notEmpty=function(b,e){if(b===a||null===b)throw Error("Parameter '"+e+"' cannot be null or undefined");
};this.condition=function(a,b){if(!a)throw Error(b||"An error occured");};this.isEmpty=b;this.isNotEmpty=function(a){return!b(a)};this.areSame=e;this.value=function(a){return new m(a)}}).call(this.H.Check);(function(a,b,m){function e(b,c,f){a.condition("15b6d1fc81a043c081242617308b4fdc"===f,"GameTieMode must not be instantiated. Use TieMode enum.");a.notEmpty(b,"id");a.notEmpty(c,"pointByDifferenceFunc");a.condition("function"===typeof c,"pointByDifferenceFunc must be a function returning tennisPoint via point difference");this.PointByDifference=function(a){return c.call(null,a)};this.id=b}function d(b){a.notEmpty(b,"label");this.label=b;this.id=l(b)}function p(b,c,f,d){a.condition("82ee546ae51f4a77a048186fa13e98f1"===
d,"PointType must not be instantiated. Use PointTypes enum.");a.notEmpty(c,"label");a.notEmpty(f,"shotStyle");a.condition(b===w.PointWinner||b===w.PointLoser,"Point credit goes to winner or loser. Use pointCreditTypes enum");this.label=c;this.creditTo=b;this.shotStyle=f;this.id=l(c)}function l(a){return b(a).trim().replaceAll(" ","").replaceAll("/","").s}var v={Love:{id:"Love",code:"0"},Fifteen:{id:"Fifteen",code:"15"},Thirty:{id:"Thirty",code:"30"},Fourty:{id:"Fourty",code:"40"},Advantage:{id:"Advantage",
code:"Ad"}},t={advantageWin:new e("AdvantageWin",function(b){a.condition(a.value(b).isBetweenInclusive(-1,1),"Something is wrong, point difference must be [-1,1]");return a.value(b).isBetweenInclusive(-1,0)?v.Fourty:1===b?v.Advantage:v.Love},"15b6d1fc81a043c081242617308b4fdc"),singlePointWin:new e("SinglePointWin",function(b){a.condition(a.value(b).isBetweenInclusive(-1,1),"Something is wrong, point difference must be [-1,1]");return 0===b?v.Fourty:v.Love},"15b6d1fc81a043c081242617308b4fdc")},x={tiebreak:{id:"TieBreak",
minimumGamePoints:7},superTiebreak:{id:"SuperTieBreak",minimumGamePoints:10},gameDifference:{id:"GameDifference",minimumGamePoints:4}};m={NormalPassing:new d("Normal/Passing"),Volley:new d("Volley"),Smash:new d("Smash"),Lob:new d("Lob"),Drop:new d("Drop")};var w={PointWinner:0,PointLoser:1};this.Model={Player:function(b){a.notEmpty(b,"name");var c=this;this.name=b;this.id=l(b);this.setName=function(a){c.name=a;c.id=l(a)}},MatchDefinition:function(b,c,f){a.notEmpty(b,"playerOne");a.notEmpty(c,"playerTwo");
this.players=[b,c];this.gamesPerSet=6;this.setsCount=3;this.gameTieMode=t.advantageWin;this.lastSetTieMode=x.tiebreak;this.startingPlayer=f?c:b},TieMode:t,LastSetTieMode:x,Point:function(b,c,f,d){a.notEmpty(b,"forPlayer");a.notEmpty(c,"creditedTo");a.notEmpty(f,"type");this.player=b;this.creditedTo=c;this.timestamp=new Date;this.type=f;this.isOnSecondServe=d},ShotStyles:m,PointCreditTypes:w,PointTypes:{WinningShot:function(a){return new p(w.PointWinner,"Winning Shot",a,"82ee546ae51f4a77a048186fa13e98f1")},
ForcedError:function(a){return new p(w.PointWinner,"Forced Error",a,"82ee546ae51f4a77a048186fa13e98f1")},UnforcedError:function(a){return new p(w.PointLoser,"Unforced Error",a,"82ee546ae51f4a77a048186fa13e98f1")},Ace:function(a){return new p(w.PointWinner,"Ace",a,"82ee546ae51f4a77a048186fa13e98f1")},DoubleFault:function(a){return new p(w.PointLoser,"Double Fault",a,"82ee546ae51f4a77a048186fa13e98f1")}},PointType:p,TennisPoints:v}}).call(this.H.TennisScoreKeeper,this.H.Check,this.S);(function(a,b,m){function e(d){a.notEmpty(d,"player");this.Player=d;this.Game=b.TennisPoints.Love;this.Sets=this.Games=this.GamePoints=0}function d(b,d,e,m){a.notEmpty(b,"playerOneScoreProjection");a.notEmpty(d,"playerTwoScoreProjection");a.notEmpty(e,"setsPerMatch");a.notEmpty(m,"servingPlayer");var p=this,r=Math.ceil(e/2);this.PlayerOne=b;this.PlayerTwo=d;this.Winner=function(){return b.Sets===r?b:d.Sets===r?d:null};this.IsWon=function(){return null!==p.Winner()};this.ServingPlayer=function(){return m}}
var p=[b.TennisPoints.Love,b.TennisPoints.Fifteen,b.TennisPoints.Thirty,b.TennisPoints.Fourty];this.ScoreProjector=function(l,v){function t(b){a.notEmpty(b,"points");var c=new e(l.players[0]),f=new e(l.players[1]);z=l.startingPlayer;aa=b;for(var s=0;s<b.length;s++){var m=b[s];A=m;m.player===c.Player?x(c,f):x(f,c)}b=new d(c,f,l.setsCount,z);b.IsWon()&&n("raiseOnMatchWon",[new u(c,f,"22eb1d7990b640aab2c47aa9ba18572f")]);return b}function x(d,e){d.GamePoints++;n("raiseOnPointWon",[new u(d,e,"22eb1d7990b640aab2c47aa9ba18572f")]);
if(f(d,e))s=z,0!==(d.GamePoints+e.GamePoints)%2&&(r(),n("raiseOnServeChange",[new u(d,e,"22eb1d7990b640aab2c47aa9ba18572f")])),2<=d.GamePoints-e.GamePoints&&d.GamePoints>=(d.Sets!==e.Sets||d.Sets!==Math.floor(l.setsCount/2)?7:l.lastSetTieMode.minimumGamePoints)&&(z=s===d.Player?e.Player:d.Player,w(d,e),c(d,e));else if(3>=d.GamePoints)d.Game=p[d.GamePoints];else if(a.value(d.GamePoints-e.GamePoints).isBetweenInclusive(-1,1)){var m=d.GamePoints-e.GamePoints;d.Game=l.gameTieMode.PointByDifference(m);
e.Game=l.gameTieMode.PointByDifference(-m);0<m&&(d.Game==b.TennisPoints.Love&&e.Game==b.TennisPoints.Love)&&w(d,e)}else w(d,e)}function w(a,d){n("raiseOnGameWon",[new u(a,d,"22eb1d7990b640aab2c47aa9ba18572f")]);a.Game=b.TennisPoints.Love;d.Game=b.TennisPoints.Love;a.GamePoints=0;d.GamePoints=0;a.Games++;r();n("raiseOnServeChange",[new u(a,d,"22eb1d7990b640aab2c47aa9ba18572f")]);2<=a.Games-d.Games&&a.Games>=l.gamesPerSet&&c(a,d)}function r(){z=z===l.players[0]?l.players[1]:l.players[0]}function c(a,
b){n("raiseOnSetWon",[new u(a,b,"22eb1d7990b640aab2c47aa9ba18572f")]);a.Games=0;b.Games=0;a.Sets++}function f(a,c){var d=a.Games===l.gamesPerSet&&c.Games===l.gamesPerSet;return a.Sets!==c.Sets||a.Sets!==Math.floor(l.setsCount/2)?d:d&&l.lastSetTieMode!==b.LastSetTieMode.gameDifference}function n(a,b){v&&v[a].apply(m,b)}function u(b,c,d){a.condition("22eb1d7990b640aab2c47aa9ba18572f"===d,"HookArgs must not be instantiated. They are exposed for intellisense");this.WinningPlayer=b.Player;this.WinningGamePoints=
b.GamePoints;this.LosingPlayer=c.Player;this.LosingGamePoints=c.GamePoints;this.ServingPlayer=z;this.IsTiebreak=f(b,c);this.DecidingPoint=A;this.AllPoints=aa}a.notEmpty(l,"gameDefinition");var z=l.startingPlayer,s=null,A=null,aa=[];this.processPoints=this.toTennisScore=t;this.HookArgs=u};this.ScoreProjectorHooks=function(a,b,d,e,p){function r(a,b){"function"===typeof a&&a.apply(m,b)}var c=this;this.onPointWon=a;this.onGameWon=b;this.onSetWon=d;this.onMatchWon=e;this.onServeChange=p;this.raiseOnPointWon=
function(){r(c.onPointWon,arguments)};this.raiseOnGameWon=function(){r(c.onGameWon,arguments)};this.raiseOnSetWon=function(){r(c.onSetWon,arguments)};this.raiseOnMatchWon=function(){r(c.onMatchWon,arguments)};this.raiseOnServeChange=function(){r(c.onServeChange,arguments)}}}).call(this.H.TennisScoreKeeper,this.H.Check,this.H.TennisScoreKeeper.Model);(function(a,b,m){function e(){var a=this;this.Points=[];this.Games=[];this.Sets=[];this.SetsScore=0;this.Score=function(){return a.SetsScore};this.SetScore=function(){return 0===a.Sets.length?0:a.Sets[a.Sets.length-1].Score()};this.GameScore=function(){return 0===a.Games.length?0:a.Games[a.Games.length-1].Score()}}function d(){var a=this;this.Games=[];this.TiebreakGame=m;this.IsWon=!1;this.Score=function(){return a.Games.length}}function p(){var a=this;this.Points=[];this.Score=function(){return a.Points.length}}
function l(a,b,d){var l=this;this.PlayerOne={Player:a,Score:new e};this.PlayerTwo={Player:b,Score:new e};this.ServingPlayer=d;this.forPlayer=function(a){return l.PlayerOne.Player===a?l.PlayerOne:l.PlayerTwo};this.forOpponent=function(a){return l.PlayerOne.Player===a?l.PlayerTwo:l.PlayerOne}}var v=this;this.DetailedScoreProjector=function(b){a.notEmpty(b,"gameDefinition");var e=new l(b.players[0],b.players[1],b.startingPlayer),m=new v.ScoreProjector(b,new v.ScoreProjectorHooks(function(a){var b=e.forPlayer(a.WinningPlayer).Score;
b.Points.push(a.DecidingPoint);0===b.Games.length&&b.Games.push(new p);b.Games[b.Games.length-1].Points.push(a.DecidingPoint)},function(a){var b=e.forPlayer(a.WinningPlayer).Score,f=e.forPlayer(a.LosingPlayer).Score;0===b.Sets.length&&b.Sets.push(new d);b.Sets[b.Sets.length-1].Games.push(b.Games[b.Games.length-1]);a.IsTiebreak&&(b.Sets[b.Sets.length-1].TiebreakGame=b.Games[b.Games.length-1],f.Sets[f.Sets.length-1].TiebreakGame=f.Games[f.Games.length-1]);b.Games.push(new p);f.Games.push(new p)},function(a){var b=
e.forPlayer(a.WinningPlayer).Score;b.SetsScore++;b.Sets[b.Sets.length-1].IsWon=!0;b.Sets.push(new d);e.forPlayer(a.LosingPlayer).Score.Sets.push(new d)},function(a){e.forPlayer(a.WinningPlayer).Score.Sets.pop();e.forPlayer(a.LosingPlayer).Score.Sets.pop()},function(a){e.ServingPlayer=a.ServingPlayer}));this.projectScore=function(a){e=new l(b.players[0],b.players[1],b.startingPlayer);m.processPoints(a);return e}}}).call(this.H.TennisScoreKeeper,this.H.Check,this.H.TennisScoreKeeper.Model);(function(a,b){function m(){this.PointsWonOnOwnMerit=this.ReceivingPointsWon=this.ReceivingPoints=this.BreakPointsWon=this.BreakPoints=this.PointsOnSecondService=this.PointsOnFirstService=this.Winners=this.ForcedErrors=this.UnforcedErrors=this.DoubleFaults=this.Aces=this.SecondServeIn=this.FirstServeIn=this.TotalServes=this.Points=0}function e(){this.BreakPointsWon=this.BreakPoints=this.WinnersIncludingAces=this.Winners=this.ForcedErrors=this.UnforcedErrors=this.DoubleFaults=this.Aces=this.Serves=
this.Points=0}function d(a,d,l){b.notEmpty(a,"playerOne");b.notEmpty(d,"playerTwo");this.Overall=new e;this.ForPlayerOne={Player:a,Statistics:new m};this.ForPlayerTwo={Player:d,Statistics:new m};this.ForPlayer=function(a){return this.ForPlayerOne.Player===a?this.ForPlayerOne.Statistics:this.ForPlayerTwo.Statistics};l&&l.call(this,this)}function p(a,e){b.notEmpty(a,"playerOne");b.notEmpty(e,"playerTwo");this.PerMatch=new d(a,e,function(){this.PerSet=[new d(a,e,function(){this.PerGame=[new d(a,e)]})]})}
var l=this;this.MatchStatisticsProjector=function(e){function m(){c.PerMatch.PerSet.push(new d(e.players[0],e.players[1],function(){this.PerGame=[new d(e.players[0],e.players[1])]}))}function x(a,b){var c=b.ForPlayerOne.Player===a.ServingPlayer?b.ForPlayerTwo.Player:b.ForPlayerOne.Player;b.Overall.Points++;b.Overall.Serves+=a.DecidingPoint.isOnSecondServe?2:1;b.Overall.Aces+=a.DecidingPoint.type.id===z.Ace?1:0;b.Overall.DoubleFaults+=a.DecidingPoint.type.id===z.DoubleFault?1:0;b.Overall.UnforcedErrors+=
a.DecidingPoint.type.id===z.UnforcedError?1:0;b.Overall.ForcedErrors+=a.DecidingPoint.type.id===z.ForcedError?1:0;b.Overall.Winners+=a.DecidingPoint.type.id===z.WinningShot?1:0;b.Overall.WinnersIncludingAces=b.Overall.Winners+b.Overall.Aces;b.Overall.BreakPoints+=w(a)?1:0;b.Overall.BreakPointsWon+=r(a)?1:0;b.ForPlayer(a.WinningPlayer).Points++;b.ForPlayer(a.ServingPlayer).TotalServes+=a.DecidingPoint.isOnSecondServe?2:1;b.ForPlayer(a.ServingPlayer).FirstServeIn+=a.DecidingPoint.isOnSecondServe?0:
1;b.ForPlayer(a.ServingPlayer).SecondServeIn+=a.DecidingPoint.isOnSecondServe?1:0;b.ForPlayer(a.WinningPlayer).Aces+=a.DecidingPoint.type.id===z.Ace?1:0;b.ForPlayer(a.LosingPlayer).DoubleFaults+=a.DecidingPoint.type.id===z.DoubleFault?1:0;b.ForPlayer(a.LosingPlayer).UnforcedErrors+=a.DecidingPoint.type.id===z.UnforcedError?1:0;b.ForPlayer(a.LosingPlayer).ForcedErrors+=a.DecidingPoint.type.id===z.ForcedError?1:0;b.ForPlayer(a.WinningPlayer).Winners+=a.DecidingPoint.type.id===z.WinningShot?1:0;b.ForPlayer(a.WinningPlayer).PointsOnFirstService+=
a.WinningPlayer!==a.ServingPlayer||a.DecidingPoint.isOnSecondServe?0:1;b.ForPlayer(a.WinningPlayer).PointsOnSecondService+=a.WinningPlayer===a.ServingPlayer&&a.DecidingPoint.isOnSecondServe?1:0;b.ForPlayer(a.WinningPlayer).BreakPoints+=w(a)?1:0;b.ForPlayer(a.WinningPlayer).BreakPointsWon+=r(a)?1:0;b.ForPlayer(c).ReceivingPoints++;b.ForPlayer(c).ReceivingPointsWon+=a.WinningPlayer===c?1:0;b.ForPlayer(a.WinningPlayer).PointsWonOnOwnMerit+=a.DecidingPoint.creditedTo===a.WinningPlayer?1:0}function w(a){return a.ServingPlayer===
a.DecidingPoint.player||3>a.WinningGamePoints?!1:3===a.WinningGamePoints&&2>=a.LosingGamePoints||1===a.WinningGamePoints-a.LosingGamePoints}function r(a){return a.ServingPlayer===a.DecidingPoint.player||4>a.WinningGamePoints?!1:4===a.WinningGamePoints&&2>=a.LosingGamePoints||2===a.WinningGamePoints-a.LosingGamePoints}b.notEmpty(e,"gameDefinition");var c=new p(e.players[0],e.players[1]),f=new l.ScoreProjector(e,new l.ScoreProjectorHooks(function(a){c.PerMatch.PerSet[n]||m();x(a,c.PerMatch);x(a,c.PerMatch.PerSet[n]);
x(a,c.PerMatch.PerSet[n].PerGame[u])},function(a){c.PerMatch.PerSet[n].PerGame.push(new d(e.players[0],e.players[1]));u++},function(a){m();u=0;n++},function(a){c.PerMatch.PerSet.pop()})),n=0,u=0,z={Ace:a.PointTypes.Ace(a.ShotStyles.NormalPassing).id,DoubleFault:a.PointTypes.DoubleFault(a.ShotStyles.NormalPassing).id,UnforcedError:a.PointTypes.UnforcedError(a.ShotStyles.NormalPassing).id,ForcedError:a.PointTypes.ForcedError(a.ShotStyles.NormalPassing).id,WinningShot:a.PointTypes.WinningShot(a.ShotStyles.NormalPassing).id};
this.project=function(a){c=new p(e.players[0],e.players[1]);u=n=0;f.processPoints(a);return c}}}).call(this.H.TennisScoreKeeper,this.H.TennisScoreKeeper.Model,this.H.Check);(function(a,b,m){function e(d){a.notEmpty(d,"players");a.condition(2===d.length,"The match must have exactly two players");this.pointFor=function(a,e,m){var x=a===d[0]?d[1]:d[0];return new b.Point(a,e.creditTo===b.PointCreditTypes.PointWinner?a:x,e,!0===m?!0:!1)}}var d=this;this.Engine=function(b,l){a.notEmpty(b,"gameDefinition");l=l||[];var m=new e(b.players),t=[],x=new d.ScoreProjector(b),t=[b.players[0],b.players[1]];this.scorePointFor=function(a,b,c){a=m.pointFor(a,b,c);l.push(a)};this.undoLatestPoint=
function(){0!==l.length&&l.pop()};this.players=t;this.points=l;this.tennisScore=function(){return x.toTennisScore(l)}};this.PointFactory=e}).call(this.H.TennisScoreKeeper,this.H.Check,this.H.TennisScoreKeeper.Model,this._);(function(a,b,m,e){function d(a,b){return m.find(a,function(a){return a.id===b})}function p(e){this.ToMatchDefinition=function(){var a=e.Metadata,b=new l.MatchDefinition(new l.Player(a.players[0].name),new l.Player(a.players[1].name),a.startingPlayer.id===a.players[1].id);b.gamesPerSet=a.gamesPerSet;b.setsCount=a.setsCount;b.gameTieMode=d(l.TieMode,a.gameTieMode.id);b.lastSetTieMode=d(l.LastSetTieMode,a.lastSetTieMode.id);return b};this.ToPoints=function(p){b.notEmpty(p,"matchDefinition");var x=new a.PointFactory(p.players);
return m.map(e.Points,function(a){return x.pointFor(d(p.players,a.player.id),l.PointTypes[a.type.id](d(l.ShotStyles,a.type.shotStyle.id)),a.isOnSecondServe)})}}var l=this;this.Convert=new function(){this.Json=function(a){return new p(a)}}}).call(this.H.TennisScoreKeeper.Model,this.H.TennisScoreKeeper,this.H.Check,this._);